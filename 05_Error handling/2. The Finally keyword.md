
---

## C# Exception Handling: The `finally` Block

The `finally` block is an optional block that comes after `try` and `catch`.

**The Golden Rule:** Code inside the `finally` block is **ALWAYS** executed, regardless of whether an exception happened or not.

### 1. Execution Flow

1. **No Error:** `try` runs ➔ `finally` runs.
    
2. **Error Occurs:** `try` stops ➔ `catch` runs ➔ `finally` runs.
    

### 2. Basic Syntax

C#

```C#
try
{
    int a = 10;
    int b = 0;
    Console.WriteLine(a / b); // Error!
}
catch (Exception ex)
{
    Console.WriteLine("Catch: An error occurred.");
}
finally
{
    // This runs NO MATTER WHAT.
    Console.WriteLine("Finally: This line always runs.");
}
```

**Output:**

Plaintext

```C#
Catch: An error occurred.
Finally: This line always runs.
```

### 3. Why use it? (Cleanup)

You might ask: _"Why not just write the code after the catch block?"_

The finally block is specifically designed for Cleaning up Resources.

If you open a File, a Database Connection, or a Network Stream, you must close it, even if the program crashes halfway through reading it.

C#

```C#
void ReadFile()
{
    // Pretend we opened a file here
    Console.WriteLine("File Opened");

    try
    {
        // Simulate an error while processing the file
        throw new Exception("File corrupted");
    }
    catch
    {
        Console.WriteLine("Error reading file");
    }
    finally
    {
        // CRITICAL: We must close the file to prevent memory leaks
        // This runs even if the catch block fails or returns.
        Console.WriteLine("File Closed");
    }
}
```

### 4. The "Return" Edge Case

This is a common interview question.

Question: If I have a return statement inside the try block, does finally still run?

Answer: YES. The finally block runs right before the method actually returns the value.

C#

```C#
public int TestMethod()
{
    try
    {
        return 10; // We are trying to leave the method
    }
    finally
    {
        Console.WriteLine("I still run!");
    }
}
// Output: 
// "I still run!"
// Returns 10
```